<!-- Test description file -->
<!-- Test steps must be sequential, starting at 001 -->
<!-- Repetitions are limited to 0xFFF,i.e. 4095		-->
<!-- Major time frame [seconds]						-->
<!-- Test End partition : partition where the test
	 will end and finish - if needed, this can be 
	 adapted										-->
<TDF>
	<!-- Test Definition -->
	<test 	name="TEST-DEF-00009"
			id="9" 
			partitions="2"
			test_end_partition="0"
			repeat="1" 
			mtf="0.3"
			ms_per_tick="2"
			type="TEST_GMV_VAL"
			personality="RTEMS48I">
		<description>
						Call the pal_schedule_change function from an authorized partition
			and check that the partitioning schedule is altered starting at the next
			major time frame (MTF) start. Check that a call to pal_schedule_change
			with the current schedule produces no change. Check that the call from a
			non-authorized partition fails with an HM process/ partition event.
		</description>
		<requirements>
			<req name="AIR_SEP_0120" />	
		</requirements>
		
		<!-- Test Procedure -->
		<testprocedure repeat="1">
      <teststep id="0" partition="0" repeat="1">
        <description>
            Get the current time, sleep for one tick, get the time again and 
            measure the difference. Must be equal to 1 for at least 19 times.
        </description>
      </teststep>
      <teststep id="1" partition="1" repeat="1">
        <description>
            Call pal_schedule_change for scheedule 1, and check that a 
            PMK_VIOL_ERR fault occured, that was captured by the partition 
            callback.
        </description>
      </teststep>
      <teststep id="2" partition="0" repeat="1">
        <description>
            Check that the last step differs (MTF - P0) ticks execution window 
            from the previously stored value.
        </description>
      </teststep>
      <teststep id="3" partition="0" repeat="1">
        <description>
            Call pal_schedule_change for schedule 1.
        </description>
      </teststep>
      <teststep id="4" partition="0" repeat="1">
        <description>
            Get the current time, sleep for one tick, get the time again and 
            measure the difference. Must be equal to 1 for at least 19 times 
            (the same value as before), since the schedule change only takes 
            effect in the next MTF
        </description>
      </teststep>
      <teststep id="5" partition="0" repeat="1">
        <description>
            Get the current time, and check that it differs MTF from previously
            stored value.
        </description>
      </teststep>
      <teststep id="6" partition="0" repeat="1">
        <description>
            Get the current time, sleep for one tick, get the time again and
            measure the difference. Must be equal to 1 for at least 9 times 
            (the value from the new schedule).
        </description>
      </teststep>
      <teststep id="7" partition="0" repeat="1">
        <description>
            Get the current time, and check that it differs MTF from previously 
            stored value.
        </description>
      </teststep>

		</testprocedure>		
	</test>	<!-- Test id="050" -->
</TDF>
