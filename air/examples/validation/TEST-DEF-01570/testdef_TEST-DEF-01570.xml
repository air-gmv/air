<!-- Test description file -->
<!-- Test steps must be sequential, starting at 001 -->
<!-- Repetitions are limited to 0xFFF,i.e. 4095		-->
<!-- Major time frame [seconds]						-->
<!-- Test End partition : partition where the test
	 will end and finish - if needed, this can be 
	 adapted										-->
<TDF>
	<!-- Test Definition -->
	<test 	name="TEST-DEF-01570"
			id="1570" 
			partitions="8"
			test_end_partition="0"
			repeat="1" 
			mtf="0.3"
			ms_per_tick="10"
			type="TEST_GMV_VAL"
			personality="RTEMS5"
			apex="IMASPEX">
		<registered_traps async="" sync="0xF0" />
		<description>
						Create a test for the FREEZE_CACHE service. Run the same code in a
			second non-authorized partition and check that the error is detected.
		</description>
		<requirements>
			<req name="AIR_SEP_0960" />	
		</requirements>
		
		<!-- Test Procedure -->
		<testprocedure repeat="1">
			<teststep id="0" partition="0" repeat="1">
				<description>
					Call FREEZE_CACHE without IMASPEX being initialized. Return Code: INVALID_MODE
				</description>
			</teststep>
			<teststep id="1" partition="0" repeat="1">
				<description>
					Init IMASPEX
				</description>
			</teststep>
			<teststep id="2" partition="0" repeat="1">
				<description>
					Call FREEZE_CACHE with an invalid Cache Type argument. Return Code: INVALID_PARAM
				</description>
			</teststep>
			<teststep id="3" partition="0" repeat="1">
				<description>
					Try to freeze Both Caches. Since they are disabled at configuration level the return code shall be INVALID_MODE.
				</description>
			</teststep>
			<teststep id="4" partition="0" repeat="1">
				<description>
					Read the cache control register and verify that both caches remain disabled.
				</description>
			</teststep>			
			<teststep id="5" partition="1" repeat="1">
				<description>
					Call FREEZE_CACHE for every CACHE_TYPE when cache management is not allowed at configuration level. Return Code: INVALID_CONFIG
				</description>
			</teststep>
			<teststep id="6" partition="2" repeat="1">
				<description>
					Try to freeze the instruction cache. Since instruction the cache is enabled at configuration level the return code shall be NO_ERROR.
				</description>
			</teststep>
			<teststep id="7" partition="2" repeat="1">
				<description>
					Try to freeze the data cache. Since the data cache is disabled at configuration level the return code shall be INVALID_MODE.
				</description>
			</teststep>
			<teststep id="8" partition="2" repeat="1">
				<description>
					Read the cache control register and verify that the intruction cache is frozen and the data cache disabled.
				</description>
			</teststep>
			<teststep id="9" partition="3" repeat="1">
				<description>
					Try to freeze the data cache. Since data the cache is enabled at configuration level the return code shall be NO_ERROR.
				</description>
			</teststep>
			<teststep id="10" partition="3" repeat="1">
				<description>
					Try to freeze the instruction cache. Since the instruction cache is disabled at configuration level the return code shall be INVALID_MODE.
				</description>
			</teststep>
			<teststep id="11" partition="3" repeat="1">
				<description>
					Read the cache control register and verify that the data cache is frozen and the instruction cache disabled.
				</description>
			</teststep>
			<teststep id="12" partition="4" repeat="1">
				<description>
					Try to freeze the instruction cache. Since instruction the cache is already frozen at configuration level the return code shall be NO_ACTION.
				</description>
			</teststep>
			<teststep id="13" partition="4" repeat="1">
				<description>
					Try to freeze the data cache. Since the data cache is disabled at configuration level the return code shall be INVALID_MODE.
				</description>
			</teststep>
			<teststep id="14" partition="4" repeat="1">
				<description>
					Try to freeze both caches. Action shall succeed with NO_ERROR. TODO
				</description>
			</teststep>
			<teststep id="15" partition="5" repeat="1">
				<description>
					Try to freeze the data cache. Since data the cache is already frozen at configuration level the return code shall be NO_ACTION.
				</description>
			</teststep>
			<teststep id="16" partition="5" repeat="1">
				<description>
					Try to freeze the instruction cache. Since the instruction cache is disabled at configuration level the return code shall be INVALID_MODE.
				</description>
			</teststep>
			<teststep id="17" partition="5" repeat="1">
				<description>
					Try to freeze both caches. Action shall succeed with NO_ERROR. TODO
				</description>
			</teststep>
			<teststep id="18" partition="6" repeat="1">
				<description>
					Try to freeze Both Caches. Although one of the caches is already frozen the action shall succeed with NO_ERROR.
				</description>
			</teststep>
			<teststep id="19" partition="6" repeat="1">
				<description>
					Read the cache control register and verify that both caches are frozen.
				</description>
			</teststep>
			<teststep id="20" partition="7" repeat="1">
				<description>
					Try to freeze Both Caches. Action shall succeed with NO_ERROR.
				</description>
			</teststep>
			<teststep id="21" partition="7" repeat="1">
				<description>
					Read the cache control register and verify that both caches are frozen
				</description>
			</teststep>
			<teststep id="22" partition="7" repeat="1">
				<description>
					Try to freeze Both Caches. Since both caches are frozen at configuration level the return code shall be NO_ACTION.
				</description>
			</teststep>
		</testprocedure>		
	</test>	<!-- Test id="1570" -->
</TDF>