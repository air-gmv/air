#
# Makefile : POS bare - Bare C support
# Generated by XKY Configurator Tool v3.5
#

TARGET_BUILD=../../install/pos/bare

TARGET_LIBRARY=../../install/pos/bare/bare.a

include ../../Makefile.inc 

TARGET_HEADERS=\
../../pmk/bsp/sparc/leon3/include/amba.h\
../../pmk/core/include/ports_queuing.h\
../../pmk/arch/sparc/include/asm.h\
../../pmk/bsp/sparc/leon3/include/l2cache.h\
../../pmk/arch/sparc/include/cpu.h\
../../pmk/core/include/sharedmemory.h\
../../pmk/arch/sparc/include/sparc.h\
../../pmk/arch/sparc/include/xky_arch.h\
../../pmk/bsp/sparc/leon3/include/irqmp.h\
../../pmk/core/include/barrier.h\
../../pmk/core/include/loader.h\
../../pmk/core/include/xky.h\
../../pmk/core/include/partition.h\
../../pmk/core/include/ipc.h\
../../pmk/bsp/sparc/leon3/include/gaisler.h\
../../pmk/core/include/printk.h\
sparc/linkcmds.ld\
../../pmk/core/include/health_monitor.h\
../../pmk/core/include/multicore.h\
../../pmk/core/include/schedule.h\
../../pmk/bsp/sparc/leon3/include/console.h\
../../pmk/core/include/pmk.h\
../../pmk/arch/sparc/include/asm_offsets.h\
../../pmk/core/include/ports.h\
../../pmk/core/include/devices.h\
../../pmk/core/include/rvs.h\
../../pmk/core/include/segregation.h\
../../pmk/bsp/sparc/leon3/include/bsp.h\
../../pmk/core/include/tod.h\
sparc/include/bare.h\
../../pmk/core/include/syscall.h\
../../pmk/bsp/sparc/leon3/include/iommu.h\
../../pmk/bsp/sparc/leon3/include/clock.h\
../../pmk/core/include/configurations.h\
../../pmk/core/include/ports_sampling.h\
../../pmk/arch/sparc/include/atomic.h\
../../pmk/core/include/error.h\
../../pmk/core/include/workspace.h

TARGET_SOURCES=\
sparc/smp.c\
sparc/isr.c\
sparc/start.S\
sparc/smp_asm.S\
sparc/isr_asm.S

TARGET_OBJECTS=\
$(patsubst %.c,$(TARGET_BUILD)/%.o,\
$(patsubst %.S,$(TARGET_BUILD)/%.o,$(TARGET_SOURCES)))

TARGET_CPPFLAGS+=\
-DPMK_MAX_CORES=4\
-DPMK_SPARC_LEON4\
-Isparc\
-I../../pmk/core/include\
-I../../pmk/arch/sparc/include\
-I../../pmk/bsp/sparc/leon3/include\
-Isparc/include

LIBRARY_HEADERS=\
sparc/include/bare.h\
sparc/linkcmds.ld

# All
.PHONY : all
all: $(TARGET_LIBRARY)

# Library
$(TARGET_LIBRARY): $(TARGET_OBJECTS) $(TARGET_HEADERS)
	$(call make-target-library, $@, $(TARGET_OBJECTS))
	@($(TESTD) ../../install/pos/bare/include || $(MKDIR) ../../install/pos/bare/include)
	@$(foreach obj,$(LIBRARY_HEADERS),$(CP) $(obj) ../../install/pos/bare/include/$(dirname $(obj));)

# Clean
.PHONY : clean
clean:
	@($(RM) $(TARGET_BUILD))

# Distclean
.PHONY : distclean
distclean: clean
	@($(RM) Makefile)
