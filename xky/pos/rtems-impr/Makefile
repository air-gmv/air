#
# Makefile : POS RTEMS-IMPR - RTEMS-IMPR personality
# Generated by XKY Configurator Tool v3.5
#
# Makefile Include file
include ../../Makefile.inc 

CURRENT_PATH=$(shell pwd)

# reguired XKY headers
XKY_HEADERS=\
-I/home/$(AIR_RUNNER_USER)/xky/pmk/arch/sparc/include\
-I/home/$(AIR_RUNNER_USER)/xky/pmk/core/include

# RTEMS build and install directories
RTEMS_BUILD_DIR=../../install/pos/rtems-impr/rtems-impr-build
RTEMS_INSTALL_DIR=/home/$(AIR_RUNNER_USER)/xky/install/pos/rtems-impr/rtems-impr-install
EDILIB_BUILD_DIR=../../../install/pos/rtems-impr/edilib

# All
.PHONY : all
all: rtems-impr

# RTEMS 4.10
.PHONY : rtems-impr
rtems-impr:
	if [ ! -d "$(RTEMS_BUILD_DIR)" ]; then \
	$(MKDIR) $(RTEMS_BUILD_DIR) && \
	$(MKDIR) ../../install/pos/rtems-impr/edilib && \
	cd $(RTEMS_BUILD_DIR); $(CURRENT_PATH)/rtems-impr/configure \
		--target=$(RTEMS_TARGET) \
		--enable-rtems-inlines \
		--disable-itron \
		--disable-multiprocessing \
		--disable-posix \
		--disable-networking \
		--disable-cxx \
		--disable-tests \
		--enable-rtemsbsp=$(RTEMS_BSP) \
		--prefix=$(RTEMS_INSTALL_DIR) && cd ..; \
	fi
	make -C $(RTEMS_BUILD_DIR) CPPFLAGS='$(XKY_HEADERS)' && \
	make -C $(RTEMS_BUILD_DIR) install && \
	make -C edilib BUILD_DIR='$(EDILIB_BUILD_DIR)'

# Clean
.PHONY : clean
clean:
	@($(RM) ../../install/pos/rtems-impr)

# Distclean
.PHONY : distclean
distclean:
	@($(RM) ../../install/pos/rtems-impr)
	@($(RM) Makefile)


