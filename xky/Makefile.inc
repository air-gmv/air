#
# Makefile : XKY OS - Makefile
# Generated by XKY Configurator Tool v3.5
#

# Default tools
CD=cd
CP=cp -ru
RM=rm -rf
MKDIR=mkdir -p
ECHO=echo -e
MV=mv
SYMLINK=ln -s
TESTD=test -d

# Host compiler
HOST_CC=gcc
HOST_CXX=g++
HOST_LD=ld
HOST_AR=ar
HOST_RANLIB=ranllib

# Host compilation flags
HOST_CFLAGS = -g
HOST_CPPFLAGS = -g -Wall
HOST_CXXFLAGS = -g
HOST_LDFLAGS = -g
HOST_ARFLAGS =

# Target compiler
TARGET_CC=sparc-rtems4.11-gcc --pipe
TARGET_CXX=sparc-rtems4.11-g++ --pipe
TARGET_LD=sparc-rtems4.11-gcc --pipe
TARGET_AR=sparc-rtems4.11-ar
TARGET_RANLIB=sparc-rtems4.11-ranlib

# Target compilation flags
TARGET_CFLAGS=
TARGET_CPPFLAGS=-mcpu=v8 -msoft-float -mflat -fno-builtin -nodefaultlibs -gdwarf-2 -O2 -Wall
TARGET_CXXFLAGS=
TARGET_LDFLAGS=
TARGET_ARFLAGS=ruv

# Rule to compile C source for HOST
$(HOST_BUILD)/%.o: %.c
	@($(TESTD) $(dir $@) || $(MKDIR) $(dir $@))
	$(HOST_CC) $(HOST_CPPFLAGS) $(HOST_CFLAGS) -c $< -o $@

# Rule to compile C++ source for HOST
$(HOST_BUILD)/%.o: %.cc
	@($(TESTD) $(dir $@) || $(MKDIR) $(dir $@))
	$(HOST_CXX) $(HOST_CPPFLAGS) $(HOST_CXXFLAGS) -c $< -o $@

# Rule to compile C++ source for HOST
$(HOST_BUILD)/%.o: %.cpp
	@($(TESTD) $(dir $@) || $(MKDIR) $(dir $@))
	$(HOST_CXX) $(HOST_CPPFLAGS) $(HOST_CXXFLAGS) -c $< -o $@

# Rule to compile C source for TARGET
$(TARGET_BUILD)/%.o: %.c
	@($(TESTD) $(dir $@) || $(MKDIR) -p $(dir $@))
	$(TARGET_CC) $(TARGET_CPPFLAGS) $(TARGET_CFLAGS) -c $< -o $@

# Rule to compile Assembly source for TARGET
$(TARGET_BUILD)/%.o: %.S
	@($(TESTD) $(dir $@) || $(MKDIR) -p $(dir $@))
	$(TARGET_CC) $(TARGET_CPPFLAGS) $(TARGET_CFLAGS) -DASM -c $< -o $@

# Rule to compile C++ source for TARGET
$(TARGET_BUILD)/%.o: %.cc
	@($(TESTD) $(dir $@) || $(MKDIR) -p $(dir $@))
	$(TARGET_CXX) $(TARGET_CPPFLAGS) $(TARGET_CXXFLAGS) -c $< -o $@

# Rule to compile C++ source for TARGET
$(TARGET_BUILD)/%.o: %.cpp
	@($(TESTD) $(dir $@) || $(MKDIR) -p $(dir $@))
	$(TARGET_CXX) $(TARGET_CPPFLAGS) $(TARGET_CXXFLAGS) -c $< -o $@

# Build library routine for HOST
define make-host-library
@($(ECHO) '\nCreating $(notdir $(1))\n')
@($(RM) $(1))
@($(TESTD) $(dir $(1)) || $(MKDIR) $(dir $(1)))
@($(HOST_AR) $(HOST_ARFLAGS) $(1) $(2))
@($(HOST_RANLIB) $(1))
endef

# Build library routine for TARGET
define make-target-library
@($(ECHO) '\nCreating $(notdir $(1))\n')
@($(RM) $(1))
@($(TESTD) $(dir $(1)) || $(MKDIR) $(dir $(1)))
@($(TARGET_AR) $(TARGET_ARFLAGS) $(1) $(2))
@($(TARGET_RANLIB) $(1))
endef

# rtems-impr definitions
RTEMS_DIRECTORY=rtems-impr
RTEMS_TARGET=sparc-rtems
RTEMS_BSP=leon3
RTEMS_EXTERNAL_LIBRARY=edilib/library

